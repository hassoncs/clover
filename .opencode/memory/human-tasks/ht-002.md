# Implement Sheet Prompt Builder

**Type**: decision-needed
**Priority**: low
**Source**: api/src/ai/pipeline/prompt-builder.ts:80
**Detected**: 2026-01-24

## Context

The `buildSheetPrompt` function in the asset generation pipeline returns a TODO placeholder:

```typescript
function buildSheetPrompt(spec: SheetSpec): string {
  return 'TODO: implement sheet prompt';
}
```

This function is responsible for building prompts for sprite sheet generation, which would allow generating multiple sprites in a single image that can be sliced into individual frames.

## Why Human Required

This requires design decisions about sprite sheet generation:

1. **Layout Strategy**
   - Grid layout (e.g., 4x4, 8x8)?
   - Packed layout (irregular spacing)?
   - How to specify layout in the prompt?

2. **Prompt Engineering**
   - How to instruct the AI to generate multiple sprites in one image?
   - How to ensure consistent style across all sprites in the sheet?
   - How to handle spacing and padding?

3. **Use Cases**
   - Animation frames (e.g., walk cycle, jump sequence)?
   - Variations of the same object (e.g., different colored blocks)?
   - Related objects (e.g., UI elements, power-ups)?

4. **Integration with Existing Pipeline**
   - Should sprite sheets use img2img or txt2img?
   - How to handle background removal for sheets?
   - How to slice the sheet into individual sprites?

## Current Asset Pipeline

The existing pipeline supports:
- `entity` - Single sprite with silhouette → img2img
- `background` - Full-frame image with txt2img
- `title_hero` - Title logo with txt2img → removeBg
- `parallax` - Multi-layer backgrounds with layeredDecompose

Sprite sheets would be a new asset type that generates multiple sprites in one API call.

## Potential Approaches

### Option A: Grid-Based Sheets
Generate a prompt that explicitly requests a grid layout:

```
"A sprite sheet with 8 variations arranged in a 2x4 grid.
Each sprite is a [description].
Consistent style, evenly spaced, transparent background between sprites."
```

### Option B: Animation Frames
Focus on animation sequences:

```
"An animation sprite sheet showing 6 frames of a [character] [action].
Frames arranged horizontally, consistent spacing, transparent background."
```

### Option C: Defer to Post-Processing
Generate sprites individually and composite them into a sheet programmatically.

**Pros**: More control over layout, easier to ensure consistency
**Cons**: More API calls, slower generation

## Related Files

- `api/src/ai/pipeline/prompt-builder.ts` - Prompt building logic
- `api/src/ai/pipeline/types.ts` - Pipeline type definitions
- `api/src/ai/scenario.ts` - Scenario.com API client
- `docs/asset-generation-knowledge.md` - Asset generation documentation

## Notes

This is marked as **low priority** because:
1. Individual sprite generation is working well
2. No immediate use case requires sprite sheets
3. Can be implemented later when animation or variation systems are needed
